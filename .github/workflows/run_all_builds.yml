name: Run All Target Builds

on:
  workflow_dispatch:

jobs:
  dispatch:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger build workflows
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const workflows = [
              'cmake_linux.yml',
              'cmake_macos.yml',
              'cmake_windows_msys2.yml'
            ];
            const ref = context.ref;
            for (const wf of workflows) {
              await github.rest.actions.createWorkflowDispatch({
                owner: context.repo.owner,
                repo: context.repo.repo,
                workflow_id: wf,
                ref: ref
              });
              core.info(`Dispatched ${wf} for ${ref}`);
            }

